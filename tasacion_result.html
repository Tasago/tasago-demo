<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tasago - Resultado de Tasación</title>
  <!-- PWA manifest and icons -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" sizes="180x180" href="icon-180x180.png" />
  <meta name="theme-color" content="#295c99" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f7faff;
      color: #2f4668;
      padding: 20px;
    }
    .container {
      max-width: 720px;
      margin: 0 auto;
    }
    .progress {
      display: flex;
      align-items: center;
      margin-bottom: 24px;
    }
    .progress .step {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .progress .step-circle {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #e5f0fa;
      color: #295c99;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 4px;
      font-size: 0.8rem;
    }
    .progress .step.active .step-circle {
      background: #295c99;
      color: #fff;
    }
    .progress .step-label {
      font-size: 0.7rem;
      color: #6b7f9b;
    }
    h1 {
      font-size: 1.4rem;
      color: #295c99;
      margin-bottom: 16px;
    }
    .summary-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }
    .summary-table th,
    .summary-table td {
      padding: 12px;
      border-bottom: 1px solid #e1ecf7;
      font-size: 0.9rem;
    }
    .summary-table th {
      background: #f0f7fd;
      color: #295c99;
      font-weight: 600;
      width: 40%;
    }
    .risks {
      margin-bottom: 24px;
    }
    .risks h2 {
      font-size: 1rem;
      color: #295c99;
      margin-bottom: 8px;
    }
    .risks ul {
      list-style: disc;
      padding-left: 20px;
      margin: 0;
    }
    .risks li {
      font-size: 0.85rem;
      margin-bottom: 6px;
      color: #4a6a8f;
    }
    .actions {
      margin-top: 16px;
    }
    .actions a {
      display: inline-block;
      background: #295c99;
      color: #ffffff;
      padding: 10px 16px;
      border-radius: 6px;
      text-decoration: none;
      margin-right: 10px;
      font-size: 0.9rem;
    }
    .actions a:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="progress">
      <div class="step">
        <div class="step-circle">1</div>
        <div class="step-label">Cotiza</div>
      </div>
      <div class="step">
        <div class="step-circle">2</div>
        <div class="step-label">Paga</div>
      </div>
      <div class="step">
        <div class="step-circle">3</div>
        <div class="step-label">Sube</div>
      </div>
      <div class="step active">
        <div class="step-circle">4</div>
        <div class="step-label">Recibe PDF</div>
      </div>
    </div>
    <h1>Resultado de tasación</h1>
    <table class="summary-table" id="summary">
      <!-- Resumen dinámico se inserta aquí -->
    </table>
    <div class="risks">
      <h2>Riesgos y supuestos</h2>
      <ul>
        <li>El valor es estimado según promedios UF/m² de la comuna seleccionada.</li>
        <li>No considera estado de mantención ni características específicas del inmueble.</li>
        <li>Las condiciones de mercado y plusvalía futura pueden afectar el valor real.</li>
      </ul>
    </div>
    <div class="actions">
      <a href="index.html">Volver al inicio</a>
      <a href="faq.html">Preguntas frecuentes</a>
    </div>
  </div>
  <script>
    function parseQuery() {
      const params = new URLSearchParams(window.location.search);
      return {
        comuna: params.get('comuna') || '',
        superficie: params.get('superficie') || '',
        zona: params.get('zona') || '',
        estacionamiento: params.get('estacionamiento') === '1',
        bodega: params.get('bodega') === '1',
        totalUF: parseFloat(params.get('totalUF') || '0'),
        totalCLP: parseFloat(params.get('totalCLP') || '0')
      };
    }
    function formatNumber(num) {
      return num.toLocaleString('es-CL');
    }
    function render() {
      const data = parseQuery();
      const table = document.getElementById('summary');
      const extras = [];
      if (data.estacionamiento) extras.push('Estacionamiento');
      if (data.bodega) extras.push('Bodega');
      const minUF = Math.round(data.totalUF * 0.95);
      const maxUF = Math.round(data.totalUF * 1.05);
      const minCLP = Math.round(data.totalCLP * 0.95);
      const maxCLP = Math.round(data.totalCLP * 1.05);
      table.innerHTML = `
        <tr><th>Comuna</th><td>${data.comuna}</td></tr>
        <tr><th>Zona</th><td>${data.zona}</td></tr>
        <tr><th>Superficie</th><td>${data.superficie} m²</td></tr>
        <tr><th>Extras</th><td>${extras.join(', ') || 'Ninguno'}</td></tr>
        <tr><th>Valor estimado</th><td>${formatNumber(data.totalUF)} UF (${formatNumber(data.totalCLP)} CLP)</td></tr>
        <tr><th>Precio sugerido (95‑105%)</th><td>${formatNumber(minUF)} – ${formatNumber(maxUF)} UF (${formatNumber(minCLP)} – ${formatNumber(maxCLP)} CLP)</td></tr>
      `;
    }
    document.addEventListener('DOMContentLoaded', render);
  </script>
</body>
</html>